{"version":3,"file":"plugin.js","sources":["../../../../src/vanilla.ts","../../../../src/plugins/virtual_scroll/plugin.ts"],"sourcesContent":["\nimport { iterate } from '@orchidjs/sifter/lib/utils';\n\n/**\n * Return a dom element from either a dom query string, jQuery object, a dom element or html string\n * https://stackoverflow.com/questions/494143/creating-a-new-dom-element-from-an-html-string-using-built-in-dom-methods-or-pro/35385518#35385518\n *\n * param query should be {}\n */\nexport const getDom = ( query:any ):HTMLElement => {\n\n\tif( query.jquery ){\n\t\treturn query[0];\n\t}\n\n\tif( query instanceof HTMLElement ){\n\t\treturn query;\n\t}\n\n\tif( isHtmlString(query) ){\n\t\tvar tpl = document.createElement('template');\n\t\ttpl.innerHTML = query.trim(); // Never return a text node of whitespace as the result\n\t\treturn tpl.content.firstChild as HTMLElement;\n\t}\n\n\treturn document.querySelector(query);\n};\n\nexport const isHtmlString = (arg:any): boolean => {\n\tif( typeof arg === 'string' && arg.indexOf('<') > -1 ){\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nexport const escapeQuery = (query:string):string => {\n\treturn query.replace(/['\"\\\\]/g, '\\\\$&');\n}\n\n/**\n * Dispatch an event\n *\n */\nexport const triggerEvent = ( dom_el:HTMLElement, event_name:string ):void => {\n\tvar event = document.createEvent('HTMLEvents');\n\tevent.initEvent(event_name, true, false);\n\tdom_el.dispatchEvent(event)\n};\n\n/**\n * Apply CSS rules to a dom element\n *\n */\nexport const applyCSS = ( dom_el:HTMLElement, css:{ [key: string]: string|number }):void => {\n\tObject.assign(dom_el.style, css);\n}\n\n\n/**\n * Add css classes\n *\n */\nexport const addClasses = ( elmts:HTMLElement|HTMLElement[], ...classes:string[]|string[][] ) => {\n\n\tvar norm_classes \t= classesArray(classes);\n\telmts\t\t\t\t= castAsArray(elmts);\n\n\telmts.map( el => {\n\t\tnorm_classes.map( cls => {\n\t\t\tel.classList.add( cls );\n\t\t});\n\t});\n}\n\n/**\n * Remove css classes\n *\n */\n export const removeClasses = ( elmts:HTMLElement|HTMLElement[], ...classes:string[]|string[][] ) => {\n\n \tvar norm_classes \t= classesArray(classes);\n\telmts\t\t\t\t= castAsArray(elmts);\n\n\telmts.map( el => {\n\t\tnorm_classes.map(cls => {\n\t \t\tel.classList.remove( cls );\n\t\t});\n \t});\n }\n\n\n/**\n * Return arguments\n *\n */\nexport const classesArray = (args:string[]|string[][]):string[] => {\n\tvar classes:string[] = [];\n\titerate( args, (_classes) =>{\n\t\tif( typeof _classes === 'string' ){\n\t\t\t_classes = _classes.trim().split(/[\\11\\12\\14\\15\\40]/);\n\t\t}\n\t\tif( Array.isArray(_classes) ){\n\t\t\tclasses = classes.concat(_classes);\n\t\t}\n\t});\n\n\treturn classes.filter(Boolean);\n}\n\n\n/**\n * Create an array from arg if it's not already an array\n *\n */\nexport const castAsArray = (arg:any):Array<any> => {\n\tif( !Array.isArray(arg) ){\n \t\targ = [arg];\n \t}\n\treturn arg;\n}\n\n\n/**\n * Get the closest node to the evt.target matching the selector\n * Stops at wrapper\n *\n */\nexport const parentMatch = ( target:null|HTMLElement, selector:string, wrapper?:HTMLElement ):HTMLElement|void => {\n\n\tif( wrapper && !wrapper.contains(target) ){\n\t\treturn;\n\t}\n\n\twhile( target && target.matches ){\n\n\t\tif( target.matches(selector) ){\n\t\t\treturn target;\n\t\t}\n\n\t\ttarget = target.parentNode as HTMLElement;\n\t}\n}\n\n\n/**\n * Get the first or last item from an array\n *\n * > 0 - right (last)\n * <= 0 - left (first)\n *\n */\nexport const getTail = ( list:Array<any>|NodeList, direction:number=0 ):any => {\n\n\tif( direction > 0 ){\n\t\treturn list[list.length-1];\n\t}\n\n\treturn list[0];\n}\n\n/**\n * Return true if an object is empty\n *\n */\nexport const isEmptyObject = (obj:object):boolean => {\n\treturn (Object.keys(obj).length === 0);\n}\n\n\n/**\n * Get the index of an element amongst sibling nodes of the same type\n *\n */\nexport const nodeIndex = ( el:null|Element, amongst?:string ):number => {\n\tif (!el) return -1;\n\n\tamongst = amongst || el.nodeName;\n\n\tvar i = 0;\n\twhile( el = el.previousElementSibling ){\n\n\t\tif( el.matches(amongst) ){\n\t\t\ti++;\n\t\t}\n\t}\n\treturn i;\n}\n\n\n/**\n * Set attributes of an element\n *\n */\nexport const setAttr = (el:Element,attrs:{ [key: string]: null|string|number }) => {\n\titerate( attrs,(val,attr) => {\n\t\tif( val == null ){\n\t\t\tel.removeAttribute(attr as string);\n\t\t}else{\n\t\t\tel.setAttribute(attr as string, ''+val);\n\t\t}\n\t});\n}\n\n\n/**\n * Replace a node\n */\nexport const replaceNode = ( existing:Node, replacement:Node ) => {\n\tif( existing.parentNode ) existing.parentNode.replaceChild(replacement, existing);\n}\n","/**\n * Plugin: \"restore_on_backspace\" (Tom Select)\n * Copyright (c) contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this\n * file except in compliance with the License. You may obtain a copy of the License at:\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF\n * ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n *\n */\n\nimport TomSelect from '../../tom-select';\nimport { TomOption } from '../../types/index';\nimport { addClasses } from '../../vanilla';\n\nexport default function(this:TomSelect) {\n\tconst self\t\t\t\t\t\t\t= this;\n\tconst orig_canLoad\t\t\t\t\t= self.canLoad;\n\tconst orig_clearActiveOption\t\t= self.clearActiveOption;\n\tconst orig_loadCallback\t\t\t\t= self.loadCallback;\n\n\tvar pagination:{[key:string]:any}\t= {};\n\tvar dropdown_content:HTMLElement;\n\tvar loading_more\t\t\t\t\t= false;\n\tvar load_more_opt:HTMLElement;\n\tvar default_values: string[]\t\t= [];\n\n\tif( !self.settings.shouldLoadMore ){\n\n\t\t// return true if additional results should be loaded\n\t\tself.settings.shouldLoadMore = ():boolean=>{\n\n\t\t\tconst scroll_percent = dropdown_content.clientHeight / (dropdown_content.scrollHeight - dropdown_content.scrollTop);\n\t\t\tif( scroll_percent > 0.9 ){\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif( self.activeOption ){\n\t\t\t\tvar selectable\t= self.selectable();\n\t\t\t\tvar index\t\t= Array.from(selectable).indexOf(self.activeOption);\n\t\t\t\tif( index >= (selectable.length-2) ){\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\t}\n\n\n\tif( !self.settings.firstUrl ){\n\t\tthrow 'virtual_scroll plugin requires a firstUrl() method';\n\t}\n\n\n\t// in order for virtual scrolling to work,\n\t// options need to be ordered the same way they're returned from the remote data source\n\tself.settings.sortField\t\t\t= [{field:'$order'},{field:'$score'}];\n\n\n\t// can we load more results for given query?\n\tconst canLoadMore = (query:string):boolean => {\n\n\t\tif( typeof self.settings.maxOptions === 'number' && dropdown_content.children.length >= self.settings.maxOptions ){\n\t\t\treturn false;\n\t\t}\n\n\t\tif( (query in pagination) && pagination[query] ){\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t};\n\n\tconst clearFilter = (option:TomOption, value:string):boolean => {\n\t\tif( self.items.indexOf(value) >= 0 || default_values.indexOf(value) >= 0 ){\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t};\n\n\n\t// set the next url that will be\n\tself.setNextUrl = (value:string,next_url:any):void => {\n\t\tpagination[value] = next_url;\n\t};\n\n\t// getUrl() to be used in settings.load()\n\tself.getUrl = (query:string):any =>{\n\n\t\tif( query in pagination ){\n\t\t\tconst next_url = pagination[query];\n\t\t\tpagination[query] = false;\n\t\t\treturn next_url;\n\t\t}\n\n\t\t// if the user goes back to a previous query\n\t\t// we need to load the first page again\n\t\tpagination = {};\n\n\t\treturn self.settings.firstUrl.call(self,query);\n\t};\n\n\n\t// don't clear the active option (and cause unwanted dropdown scroll)\n\t// while loading more results\n\tself.hook('instead','clearActiveOption',()=>{\n\n\t\tif( loading_more ){\n\t\t\treturn;\n\t\t}\n\n\t\treturn orig_clearActiveOption.call(self);\n\t});\n\n\t// override the canLoad method\n\tself.hook('instead','canLoad',(query:string)=>{\n\n\t\t// first time the query has been seen\n\t\tif( !(query in pagination) ){\n\t\t\treturn orig_canLoad.call(self,query);\n\t\t}\n\n\t\treturn canLoadMore(query);\n\t});\n\n\n\t// wrap the load\n\tself.hook('instead','loadCallback',( options:TomOption[], optgroups:TomOption[])=>{\n\n\t\tif( !loading_more ){\n\t\t\tself.clearOptions(clearFilter);\n\t\t}else if( load_more_opt ){\n\t\t\tconst first_option = options[0];\n\t\t\tif( first_option !== undefined ){\n\t\t\t\tload_more_opt.dataset.value\t\t= first_option[self.settings.valueField];\n\t\t\t}\n\t\t}\n\n\t\torig_loadCallback.call( self, options, optgroups);\n\n\t\tloading_more = false;\n\t});\n\n\n\t// add templates to dropdown\n\t//\tloading_more if we have another url in the queue\n\t//\tno_more_results if we don't have another url in the queue\n\tself.hook('after','refreshOptions',()=>{\n\n\t\tconst query\t\t= self.lastValue;\n\t\tvar option;\n\n\t\tif( canLoadMore(query) ){\n\n\t\t\toption = self.render('loading_more',{query:query});\n\t\t\tif( option ){\n\t\t\t\toption.setAttribute('data-selectable',''); // so that navigating dropdown with [down] keypresses can navigate to this node\n\t\t\t\tload_more_opt = option;\n\t\t\t}\n\n\t\t}else if( (query in pagination) && !dropdown_content.querySelector('.no-results') ){\n\t\t\toption = self.render('no_more_results',{query:query});\n\t\t}\n\n\t\tif( option ){\n\t\t\taddClasses(option,self.settings.optionClass);\n\t\t\tdropdown_content.append( option );\n\t\t}\n\n\t});\n\n\n\t// add scroll listener and default templates\n\tself.on('initialize',()=>{\n\t\tdefault_values = Object.keys(self.options);\n\t\tdropdown_content = self.dropdown_content;\n\n\t\t// default templates\n\t\tself.settings.render = Object.assign({}, {\n\t\t\tloading_more:() => {\n\t\t\t\treturn `<div class=\"loading-more-results\">Loading more results ... </div>`;\n\t\t\t},\n\t\t\tno_more_results:() =>{\n\t\t\t\treturn `<div class=\"no-more-results\">No more results</div>`;\n\t\t\t}\n\t\t},self.settings.render);\n\n\n\t\t// watch dropdown content scroll position\n\t\tdropdown_content.addEventListener('scroll',()=>{\n\n\t\t\tif( !self.settings.shouldLoadMore.call(self) ){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// !important: this will get checked again in load() but we still need to check here otherwise loading_more will be set to true\n\t\t\tif( !canLoadMore(self.lastValue) ){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// don't call load() too much\n\t\t\tif( loading_more ) return;\n\n\n\t\t\tloading_more = true;\n\t\t\tself.load.call(self,self.lastValue);\n\t\t});\n\t});\n\n};\n"],"names":["addClasses","elmts","classes","norm_classes","classesArray","castAsArray","map","el","cls","classList","add","args","iterate","_classes","trim","split","Array","isArray","concat","filter","Boolean","arg","self","orig_canLoad","canLoad","orig_clearActiveOption","clearActiveOption","orig_loadCallback","loadCallback","pagination","dropdown_content","loading_more","load_more_opt","default_values","settings","shouldLoadMore","scroll_percent","clientHeight","scrollHeight","scrollTop","activeOption","selectable","index","from","indexOf","length","firstUrl","sortField","field","canLoadMore","query","maxOptions","children","clearFilter","option","value","items","setNextUrl","next_url","getUrl","call","hook","options","optgroups","clearOptions","first_option","undefined","dataset","valueField","lastValue","render","setAttribute","querySelector","optionClass","append","on","Object","keys","assign","no_more_results","addEventListener","load"],"mappings":"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"}